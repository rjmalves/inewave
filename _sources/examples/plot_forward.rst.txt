
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/plot_forward.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_plot_forward.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_plot_forward.py:


=====================================================
Leitura dos binários forwarh.dat e forward.dat
=====================================================

.. GENERATED FROM PYTHON SOURCE LINES 9-15

.. warning::

    Estes arquivos podem mudar de formato com frequência mediante o versionamento
    do modelo. Recomenda-se atenção com o uso da propriedade `set_version` para a
    versão correta e, caso esta não seja suportada, a abertura de uma `issue <https://github.com/rjmalves/inewave/issues>`_.


.. GENERATED FROM PYTHON SOURCE LINES 17-19

Para ilustrar o processamento destes arquivos, serão usados módulos de visualização
como o plotly

.. GENERATED FROM PYTHON SOURCE LINES 19-24

.. code-block:: Python

    import plotly.io as pio

    pio.templates.default = "ggplot2"









.. GENERATED FROM PYTHON SOURCE LINES 25-29

O forward.dat é o arquivo binário de saída do modelo NEWAVE que contém as informações
sobre a simulação final. Para casos oficiais, seu tamanho pode chegar a vários GB.
A leitura deste arquivo só é possível ao processar anteriormente o arquivo forwarh.dat,
que contém informações necessárias para configurar a leitura do forward.dat.

.. GENERATED FROM PYTHON SOURCE LINES 29-49

.. code-block:: Python


    from inewave.newave.forwarh import Forwarh

    arq_cabecalho = Forwarh.read("./newave/forwarh.dat")

    tamanho_registro = arq_cabecalho.tamanho_registro_arquivo_forward

    numero_estagios = 1  # arq_cabecalho.numero_estagios_estudo
    numero_forwards = 2  # arq_cabecalho.numero_series_gravadas

    numero_forwards = arq_cabecalho.numero_registros_arquivo_forward
    numero_rees = arq_cabecalho.numero_rees
    numero_submercados = arq_cabecalho.numero_submercados
    numero_total_submercados = arq_cabecalho.numero_total_submercados
    numero_patamares_carga = arq_cabecalho.numero_patamares_carga
    numero_patamares_deficit = arq_cabecalho.numero_patamares_deficit
    numero_classes_termicas_submercados = (
        arq_cabecalho.numero_classes_termicas_submercados
    )








.. GENERATED FROM PYTHON SOURCE LINES 50-53

Além do arquivo forwarh.dat, é necessário obter informações de alguns outros
arquivos de entrada, que serão utilizadas para a montagem dos `DataFrame` retornados
pelas propriedades da classe `Forward` de maneira coerente

.. GENERATED FROM PYTHON SOURCE LINES 53-76

.. code-block:: Python


    from inewave.newave import Adterm, Agrint, Confhd, Conft

    arq_adterm = Adterm.read("./newave/adterm.dat")
    arq_agrint = Agrint.read("./newave/agrint.dat")
    arq_confhd = Confhd.read("./newave/confhd.dat")
    arq_conft = Conft.read("./newave/conft.dat")

    numero_agrupamentos_intercambio = len(
        arq_agrint.agrupamentos["agrupamento"].unique()
    )

    uhes = arq_confhd.usinas
    nomes_usinas_hidreletricas = uhes["nome_usina"].to_list()
    numero_usinas_hidreletricas = len(nomes_usinas_hidreletricas)

    utes = arq_conft.usinas
    utes = utes.sort_values("submercado")
    nomes_classes_termicas = utes["nome_usina"].unique()

    lag_maximo_usinas_gnl = arq_adterm.despachos["lag"].max()









.. GENERATED FROM PYTHON SOURCE LINES 77-85

.. warning::

    Caso a leitura esteja sendo feita nos arquivos provenientes de uma execução
    oficial do modelo, recomenda-se que seja em um ambiente com quantidade suficiente
    de memória RAM. A implementação atual realiza a conversão de todos os dados lidos
    para formato de DataFrames, resultando em um grande consumo de memória. Os arquivos
    tratados neste exemplo são de uma execução reduzida específica para os testes.


.. GENERATED FROM PYTHON SOURCE LINES 88-95

A leitura do arquivo binário com os dados é feita utilizando as informações
adquiridas anteriormente. O número de estágios e simulações forward,
que deveriam ser obtidos do arquivo cabeçalho, são atribuídos manualmente como constantes,
pois o arquivo de dados foi editado manualmente para economia de espaço no repositório.
Da mesma forma, as variáveis de número de parques eólicos equivalentes e estações
de bombeamento também foram atribuídos manualmente, pois deveriam ser lidos dos
arquivos em formato LIBS, que não existiam para o caso de teste.

.. GENERATED FROM PYTHON SOURCE LINES 95-118

.. code-block:: Python


    from inewave.newave.forward import Forward

    arq_binario = Forward.read(
        "./newave/forward.dat",
        tamanho_registro=tamanho_registro,
        numero_estagios=1,
        numero_forwards=2,
        numero_rees=numero_rees,
        numero_submercados=numero_submercados,
        numero_total_submercados=numero_total_submercados,
        numero_patamares_carga=numero_patamares_carga,
        numero_patamares_deficit=numero_patamares_deficit,
        numero_agrupamentos_intercambio=numero_agrupamentos_intercambio,
        numero_classes_termicas_submercados=numero_classes_termicas_submercados,
        numero_usinas_hidreletricas=numero_usinas_hidreletricas,
        lag_maximo_usinas_gnl=lag_maximo_usinas_gnl,
        numero_parques_eolicos_equivalentes=0,
        numero_estacoes_bombeamento=0,
        nomes_classes_termicas=nomes_classes_termicas,
        nomes_usinas_hidreletricas=nomes_usinas_hidreletricas,
    )








.. GENERATED FROM PYTHON SOURCE LINES 119-122

O arquivo binário possui um grande número de propriedades, que podem
ser consultadas diretamente na documentação do :ref:`Forward <forward>`. Um exemplo é
o custo marginal da operação em R$/MWh

.. GENERATED FROM PYTHON SOURCE LINES 122-125

.. code-block:: Python


    cmo = arq_binario.custo_marginal_operacao
    cmo





.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>estagio</th>
          <th>cenario</th>
          <th>submercado</th>
          <th>patamar</th>
          <th>valor</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>1</td>
          <td>1</td>
          <td>SUDESTE</td>
          <td>1</td>
          <td>737.010010</td>
        </tr>
        <tr>
          <th>1</th>
          <td>1</td>
          <td>1</td>
          <td>SUDESTE</td>
          <td>2</td>
          <td>737.010010</td>
        </tr>
        <tr>
          <th>2</th>
          <td>1</td>
          <td>1</td>
          <td>SUDESTE</td>
          <td>3</td>
          <td>182.199997</td>
        </tr>
        <tr>
          <th>3</th>
          <td>1</td>
          <td>1</td>
          <td>SUL</td>
          <td>1</td>
          <td>737.015015</td>
        </tr>
        <tr>
          <th>4</th>
          <td>1</td>
          <td>1</td>
          <td>SUL</td>
          <td>2</td>
          <td>737.015015</td>
        </tr>
        <tr>
          <th>5</th>
          <td>1</td>
          <td>1</td>
          <td>SUL</td>
          <td>3</td>
          <td>182.205002</td>
        </tr>
        <tr>
          <th>6</th>
          <td>1</td>
          <td>1</td>
          <td>NORDESTE</td>
          <td>1</td>
          <td>0.007271</td>
        </tr>
        <tr>
          <th>7</th>
          <td>1</td>
          <td>1</td>
          <td>NORDESTE</td>
          <td>2</td>
          <td>0.006899</td>
        </tr>
        <tr>
          <th>8</th>
          <td>1</td>
          <td>1</td>
          <td>NORDESTE</td>
          <td>3</td>
          <td>0.006899</td>
        </tr>
        <tr>
          <th>9</th>
          <td>1</td>
          <td>1</td>
          <td>NORTE</td>
          <td>1</td>
          <td>0.002271</td>
        </tr>
        <tr>
          <th>10</th>
          <td>1</td>
          <td>1</td>
          <td>NORTE</td>
          <td>2</td>
          <td>0.001899</td>
        </tr>
        <tr>
          <th>11</th>
          <td>1</td>
          <td>1</td>
          <td>NORTE</td>
          <td>3</td>
          <td>0.001899</td>
        </tr>
        <tr>
          <th>12</th>
          <td>1</td>
          <td>2</td>
          <td>SUDESTE</td>
          <td>1</td>
          <td>548.039978</td>
        </tr>
        <tr>
          <th>13</th>
          <td>1</td>
          <td>2</td>
          <td>SUDESTE</td>
          <td>2</td>
          <td>545.972778</td>
        </tr>
        <tr>
          <th>14</th>
          <td>1</td>
          <td>2</td>
          <td>SUDESTE</td>
          <td>3</td>
          <td>328.429993</td>
        </tr>
        <tr>
          <th>15</th>
          <td>1</td>
          <td>2</td>
          <td>SUL</td>
          <td>1</td>
          <td>548.044983</td>
        </tr>
        <tr>
          <th>16</th>
          <td>1</td>
          <td>2</td>
          <td>SUL</td>
          <td>2</td>
          <td>545.977783</td>
        </tr>
        <tr>
          <th>17</th>
          <td>1</td>
          <td>2</td>
          <td>SUL</td>
          <td>3</td>
          <td>328.434998</td>
        </tr>
        <tr>
          <th>18</th>
          <td>1</td>
          <td>2</td>
          <td>NORDESTE</td>
          <td>1</td>
          <td>334.051575</td>
        </tr>
        <tr>
          <th>19</th>
          <td>1</td>
          <td>2</td>
          <td>NORDESTE</td>
          <td>2</td>
          <td>334.051575</td>
        </tr>
        <tr>
          <th>20</th>
          <td>1</td>
          <td>2</td>
          <td>NORDESTE</td>
          <td>3</td>
          <td>328.424988</td>
        </tr>
        <tr>
          <th>21</th>
          <td>1</td>
          <td>2</td>
          <td>NORTE</td>
          <td>1</td>
          <td>334.046570</td>
        </tr>
        <tr>
          <th>22</th>
          <td>1</td>
          <td>2</td>
          <td>NORTE</td>
          <td>2</td>
          <td>334.046570</td>
        </tr>
        <tr>
          <th>23</th>
          <td>1</td>
          <td>2</td>
          <td>NORTE</td>
          <td>3</td>
          <td>328.424988</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.031 seconds)


.. _sphx_glr_download_examples_plot_forward.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_forward.ipynb <plot_forward.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_forward.py <plot_forward.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_forward.zip <plot_forward.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
